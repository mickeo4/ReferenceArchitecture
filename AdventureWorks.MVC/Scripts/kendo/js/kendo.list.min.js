/*
* Kendo UI Beta v2012.3.1024 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Beta license terms available at
* http://www.kendoui.com/purchase/license-agreement/kendo-ui-beta.aspx
*/

;(function(e,t){function A(t,n){t.filters&&(t.filters=e.grep(t.filters,function(e){return A(e,n),e.filters?e.filters.length:e.field!=n}))}var n=window.kendo,r=n.ui,i=r.Widget,s=n.keys,o=n.support.touch,u=n.htmlEncode,a="id",f="li",l=o?"touchend":"click",c="change",h="character",p="k-state-focused",d="k-state-hover",v="k-loading",m="open",g="close",y="select",b="selected",w="requestStart",E="requestEnd",S="width",x=e.extend,T=e.proxy,N=n.support.browser,C=N.msie&&parseInt(N.version,10)<9,k=/"/g,L=i.extend({init:function(t,r){var s=this,o=s.ns,u;i.fn.init.call(s,t,r),t=s.element,s._template(),s.ul=e('<ul unselectable="on" class="k-list k-reset"/>').css({overflow:n.support.touch?"":"auto"}).on("mouseenter"+o,f,function(){e(this).addClass(d)}).on("mouseleave"+o,f,function(){e(this).removeClass(d)}).on(l+o,f,T(s._click,s)).attr({tabIndex:-1,role:"listbox","aria-hidden":!0}),s.list=e("<div class='k-list-container'/>").append(s.ul).on("mousedown"+o,function(e){e.preventDefault()}),u=t.attr(a),u&&(s.list.attr(a,u+"-list"),s.ul.attr(a,u+"_listbox"),s._optionID=u+"_option_selected")},items:function(){return this.ul[0].children},current:function(e){var n=this,r=n._optionID;if(e===t)return n._current;n._current&&(n._current.removeClass(p).removeAttr("aria-selected").removeAttr(a),n._focused.removeAttr("aria-activedescendant")),e&&(e.addClass(p),n._scroll(e),r&&(e.attr("id",r),n._focused.attr("aria-activedescendant",r))),n._current=e},destroy:function(){var e=this,t=e.ns;i.fn.destroy.call(e),e._unbindDataSource(),e.ul.off(t),e.list.off(t),e.popup.destroy(),e._form&&e._form.off("reset",e._resetHandler)},dataItem:function(e){var n=this;return e===t&&(e=n.selectedIndex),n._data()[e]},_accessors:function(){var e=this,t=e.element,r=e.options,i=n.getter,s=t.attr(n.attr("text-field")),o=t.attr(n.attr("value-field"));s&&(r.dataTextField=s),o&&(r.dataValueField=o),e._text=i(r.dataTextField),e._value=i(r.dataValueField)},_aria:function(){var e=this,n=e.options,r=e._focused;n.suggest!==t&&r.attr("aria-autocomplete",n.suggest?"both":"list"),e.element[0].id&&r.attr("aria-owns",e.ul[0].id),e.ul.attr("aria-live",!n.filter||n.filter==="none"?"off":"polite")},_blur:function(){var e=this;e._change(),e.close()},_change:function(){var e=this,n=e.selectedIndex,r=e.value(),i;r!==e._old?i=!0:n!==t&&n!==e._oldIndex&&(i=!0),i&&(e._old=r,e._oldIndex=n,e.trigger(c),e.element.trigger(c))},_click:function(t){t.isDefaultPrevented()||(this._accept(e(t.currentTarget)),t.type==="touchend"&&t.preventDefault())},_data:function(){return this.dataSource.view()},_enable:function(){var e=this,t=e.options;e.element.prop("disabled")&&(t.enable=!1),e.enable(t.enable)},_focus:function(e){var t=this;if(t.popup.visible()&&e&&t.trigger(y,{item:e})){t.close();return}t._select(e),t._blur()},_height:function(e){if(e){var t=this,n=t.list,r=t.popup.visible(),i=t.options.height;n=n.add(n.parent(".k-animation-container")).show().height(t.ul[0].scrollHeight>i?i:"auto"),r||n.hide()}},_adjustListWidth:function(){var e=this.list,t=e[0].style.width,n=this.wrapper,r,i;if(!e.data(S)&&t)return;return r=window.getComputedStyle?window.getComputedStyle(n[0],null):0,i=r?parseFloat(r.width):n.outerWidth(),r&&(N.mozilla||N.msie)&&(i+=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)+parseFloat(r.borderLeftWidth)+parseFloat(r.borderRightWidth)),t=i-(e.outerWidth()-e.width()),e.css({fontFamily:n.css("font-family"),width:t}).data(S,t),!0},_popup:function(){var e=this,t=e.list,i=e._focused,s=e.options,o=e.wrapper;e.popup=new r.Popup(t,x({},s.popup,{anchor:o,open:function(t){e._adjustListWidth(),e.trigger(m)?t.preventDefault():(i.attr("aria-expanded",!0),e.ul.attr("aria-hidden",!1))},close:function(t){e.trigger(g)?t.preventDefault():(i.attr("aria-expanded",!1),e.ul.attr("aria-hidden",!0))},animation:s.animation,isRtl:n.support.isRtl(o)})),e._touchScroller=n.touchScroller(e.popup.element)},_makeUnselectable:function(e){C&&this.list.find("*").attr("unselectable","on")},_toggleHover:function(t){o||e(t.currentTarget).toggleClass(d,t.type==="mouseenter")},_toggle:function(e){var n=this;e=e!==t?e:!n.popup.visible(),!o&&n._focused[0]!==document.activeElement&&n._focused.focus(),n[e?m:g]()},_scroll:function(e){if(!e)return;e[0]&&(e=e[0]);var t=this.ul[0],n=e.offsetTop,r=e.offsetHeight,i=t.scrollTop,s=t.clientHeight,o=n+r;t.scrollTop=i>n?n:o>i+s?o-s:i},_template:function(){var e=this,t=e.options,r=t.template,i=t.dataSource;e.element.is(y)&&e.element[0].length&&(i||(t.dataTextField=t.dataTextField||"text",t.dataValueField=t.dataValueField||"value")),r?(r=n.template(r),e.template=function(e){return'<li tabindex="-1" role="option" unselectable="on" class="k-item">'+r(e)+"</li>"}):e.template=n.template('<li tabindex="-1" role="option" unselectable="on" class="k-item">${data'+(t.dataTextField?".":"")+t.dataTextField+"}</li>",{useWithBlock:!1})},_unbindDataSource:function(){var e=this;e.dataSource.unbind(c,e._refreshHandler).unbind(w,e._requestStartHandler).unbind(E,e._requestEndHandler)}});x(L,{caret:function(e){var t,n=e.ownerDocument.selection;return n?t=Math.abs(n.createRange().moveStart(h,-e.value.length)):t=e.selectionStart,t},selectText:function(e,t,n){try{if(e.createTextRange){e.focus();var r=e.createTextRange();r.collapse(!0),r.moveStart(h,t),r.moveEnd(h,n-t),r.select()}else e.setSelectionRange(t,n)}catch(i){}},inArray:function(e,t){var n,r,i=t.children;if(!e||e.parentNode!==t)return-1;for(n=0,r=i.length;n<r;n++)if(e===i[n])return n;return-1}}),n.ui.List=L,r.Select=L.extend({init:function(e,t){L.fn.init.call(this,e,t)},setDataSource:function(e){this.options.dataSource=e,this._dataSource(),this.options.autoBind&&this.dataSource.fetch()},close:function(){this.popup.close()},_accessor:function(e,n){var r=this.element,i=r.is(y),s,o;r=r[0];if(e===t)return i?(o=r.selectedIndex,o>-1&&(s=r.options[o],s&&(e=s.value))):e=r.value,e;i?r.selectedIndex=n:r.value=e},_hideBusy:function(){var e=this;clearTimeout(e._busy),e._arrow.removeClass(v),e._focused.attr("aria-busy",!1),e._busy=null},_showBusy:function(){var e=this;e._request=!0;if(e._busy)return;e._busy=setTimeout(function(){e._focused.attr("aria-busy",!0),e._arrow.addClass(v)},100)},_requestEnd:function(){this._request=!1},_dataSource:function(){var t=this,r=t.element,i=t.options,s=i.dataSource||{},o;s=e.isArray(s)?{data:s}:s,r.is(y)&&(o=r[0].selectedIndex,o>-1&&(i.index=o),s.select=r,s.fields=[{field:i.dataTextField},{field:i.dataValueField}]),t.dataSource&&t._refreshHandler?t._unbindDataSource():(t._refreshHandler=T(t.refresh,t),t._requestStartHandler=T(t._showBusy,t),t._requestEndHandler=T(t._requestEnd,t)),t.dataSource=n.data.DataSource.create(s).bind(c,t._refreshHandler).bind(w,t._requestStartHandler).bind(E,t._requestEndHandler)},_index:function(e){var n=this,r,i,s=n._data(),o;for(r=0,i=s.length;r<i;r++){o=n._value(s[r]),o===t&&(o=n._text(s[r]));if(o==e)return r}return-1},_get:function(t){var n=this,r=n._data(),i,s;if(typeof t=="function")for(i=0,s=r.length;i<s;i++)if(t(r[i])){t=i;break}if(typeof t=="number"){if(t<0)return e();t=e(n.ul[0].children[t])}return t&&t.nodeType&&(t=e(t)),t},_move:function(e){var t=this,n=e.keyCode,r=t.ul[0],i=t._current,o=n===s.DOWN,u;return n===s.UP||o?(e.altKey?t.toggle(o):o?(!i||t.selectedIndex===-1&&!t.value()?i=r.firstChild:i=i[0].nextSibling,t._select(i)):t._select(i?i[0].previousSibling:r.lastChild),e.preventDefault(),u=!0):n===s.ENTER||n===s.TAB?(t.popup.visible()&&e.preventDefault(),t._accept(i),u=!0):n===s.ESC&&(t.popup.visible()&&e.preventDefault(),t.close(),u=!0),u},_selectItem:function(e){var t=this,n=t.options;e=e||n.value||t.value(),e?t.value(e):t.select(n.index),t.trigger(b)},_valueOnFetch:function(e){var t=this;if(!t.ul[0].firstChild&&!t._fetch)return t.dataSource.one(c,function(){t._fetch=!0,t.value(e),t.trigger(b)}),t._request||t.dataSource.fetch(),!0;t._fetch=!1},_options:function(e,n){var r=this,i=r.element,s=i[0].selectedIndex,o=e.length,a="",f,l,c,h,p=0;n&&(a=n,p=1);for(;p<o;p++)f="<option",l=e[p],c=r._text(l),h=r._value(l),h!==t&&(h+="",h.indexOf('"')!==-1&&(h=h.replace(k,"&quot;")),f+=' value="'+h+'"'),f+=">",c!==t&&(f+=u(c)),f+="</option>",a+=f;i.html(a),i[0].selectedIndex=s},_reset:function(){var e=this,t=e.element,n=t.closest("form");n[0]&&(e._resetHandler=function(){setTimeout(function(){e.value(t[0].value)})},e._form=n.on("reset",e._resetHandler))},_cascade:function(){var n=this,r=n.options,i=r.cascadeFrom,s,o,u,a,f;if(i){s=e("#"+i).data("kendo"+r.name);if(!s)return;u=s.options.dataValueField,a=function(){n.value(""),n.enable(!1)},f=function(){var e=n.value();e?(n.value(e),n.selectedIndex==-1&&n.value("")):n.select(r.index),n.trigger(b),n.enable()},o=function(){var e=s.dataItem(),t=e?s._value(e):null,r,i;t?(r=n.dataSource.filter()||{},A(r,u),i=r.filters||[],i.push({field:u,operator:"eq",value:t}),n.dataSource.one(c,f).filter(i)):a()},s.bind("cascade",a).bind(c,function(){o(),n.trigger("cascade")}).bind(b,function(){o()}),s._valueCalled!==t?o():s.value()||n.enable(!1)}}}),r.Select.removeFiltersForField=A})(jQuery);