/*
* Kendo UI Beta v2012.3.1024 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Beta license terms available at
* http://www.kendoui.com/purchase/license-agreement/kendo-ui-beta.aspx
*/

;(function(e,t){function I(e){e.preventDefault()}function q(e){var t=n.getCulture(e.culture).calendars.standard.patterns;e.format=o(e.format||t.g),e.timeFormat=o(e.timeFormat||t.t),n.DateView.normalize(e),e.parseFormats.splice(1,0,e.timeFormat)}var n=window.kendo,r=n.TimeView,i=n.support.touch,s=n.parseDate,o=n._extractFormat,u=n.calendar,a=u.isInRange,f=u.restrictValue,l=u.isEqualDatePart,c=r.getMilliseconds,h=n.ui,p=h.Widget,d="open",v="close",m="change",g=".kendoDateTimePicker",y=(i?"touchend":"click")+g,b="disabled",w="k-state-default",E="k-state-focused",S="k-state-hover",x="k-state-disabled",T="mouseenter"+g+" mouseleave"+g,N=(i?"touchstart":"mousedown")+g,C="month",k="<span/>",L="aria-activedescendant",A="aria-expanded",O="aria-hidden",M="aria-owns",_=Date,D=new _(1900,0,1),P=new _(2099,11,31),H={view:"date"},B={view:"time"},j=e.extend,F=p.extend({init:function(t,r){var i=this;p.fn.init.call(i,t,r),t=i.element,r=i.options,q(r),i._wrapper(),i._views(),i._icons(),i._reset(),i._template(),t[0].type="text",t.addClass("k-input").on("keydown"+g,e.proxy(i._keydown,i)).on("focus"+g,function(){i._inputWrapper.addClass(E)}).on("blur"+g,function(){i._inputWrapper.removeClass(E),i._change(t.val()),i.close("date"),i.close("time")}).attr({role:"textbox","aria-haspopup":!0,"aria-expanded":!1}),i._midnight=c(r.min)+c(r.max)===0,i.enable(!t.is("[disabled]")),i.value(r.value||t.val()),n.notify(i)},options:{name:"DateTimePicker",value:null,format:"",timeFormat:"",culture:"",parseFormats:[],dates:[],min:new _(D),max:new _(P),interval:30,height:200,footer:"",start:C,depth:C,animation:{},month:{},ARIATemplate:'Current focused date is #=kendo.toString(data.current, "G")#'},events:[d,v,m],setOptions:function(e){var t=this,n=t.dateView.options,r=t.timeView.options;p.fn.setOptions.call(t,e),q(t.options),e=t.options,j(n,e,{change:n.change,close:n.close,open:n.open}),j(r,e,{format:e.timeFormat,change:r.change,close:r.close,open:r.open}),t.timeView.ul[0].innerHTML=""},enable:function(e){var t=this,n=t.element,r=t._dateIcon.off(g),s=t._timeIcon.off(g),o=t._inputWrapper.off(T);e===!1?(o.removeClass(w).addClass(x),n.attr(b,b)):(o.addClass(w).removeClass(x).on(T,t._toggleHover),n.removeAttr(b),r.on(N,I).on(y,function(){t.toggle("date"),!i&&n[0]!==document.activeElement&&n.focus()}),s.on(N,I).on(y,function(){t.toggle("time"),!i&&n[0]!==document.activeElement&&n.focus()}))},destroy:function(){var e=this;p.fn.destroy.call(e),e.dateView.destroy(),e.timeView.destroy(),e.element.off(g),e._dateIcon.off(g),e._timeIcon.off(g),e._inputWrapper.off(g),e._form&&e._form.off("reset",e._resetHandler)},close:function(e){e!=="time"&&(e="date"),this[e+"View"].close()},open:function(e){e!=="time"&&(e="date"),this[e+"View"].open()},min:function(e){return this._option("min",e)},max:function(e){return this._option("max",e)},toggle:function(e){var t="timeView";e!=="time"?e="date":t="dateView",this[e+"View"].toggle(),this[t].close()},value:function(e){var n=this;if(e===t)return n._value;n._old=n._update(e)},_change:function(e){var t=this;e=t._update(e),+t._old!=+e&&(t._old=e,t.trigger(m),t.element.trigger(m))},_option:function(e,n){var r=this,i=r.options,o=r.timeView,u=o.options,a=r._value||r._old;if(n===t)return i[e];n=s(n,i.parseFormats,i.culture);if(!n)return;i[e]=new _(n),r.dateView[e](n),r._midnight=c(i.min)+c(i.max)===0;if(a&&l(n,a)){if(r._midnight&&e=="max"){u[e]=P,o.dataBind([P]);return}u[e]=n}else u.max=P,u.min=D;o.bind()},_toggleHover:function(t){i||e(t.currentTarget).toggleClass(S,t.type==="mouseenter")},_update:function(e){var t=this,r=t.options,i=r.min,o=r.max,u=t.timeView,c=s(e,r.parseFormats,r.culture),h,p,d,v,m;return+c===+t._value?(m=n.toString(c,r.format,r.culture),m!==e&&t.element.val(c===null?e:m),c):(c!==null&&l(c,i)?c=f(c,i,o):a(c,i,o)||(c=null),t._value=c,u.value(c),t.dateView.value(c),c&&(d=t._old,p=u.options,l(c,i)&&(p.min=i,p.max=P,h=!0),l(c,o)&&(t._midnight?(u.dataBind([P]),v=!0):(p.max=o,h||(p.min=D),h=!0)),!v&&(!d&&h||d&&!l(d,c))&&(h||(p.max=P,p.min=D),u.bind())),t.element.val(c?n.toString(c,r.format,r.culture):e),t._updateARIA(c),c)},_keydown:function(e){var t=this,r=t.dateView,i=t.timeView,s=r.popup.visible();e.altKey&&e.keyCode===n.keys.DOWN?t.toggle(s?"time":"date"):s?(r.move(e),t._updateARIA(r._current)):i.popup.visible()?i.move(e):e.keyCode===n.keys.ENTER&&t._change(t.element.val())},_views:function(){var e=this,t=e.element,i=e.options,o=t.attr("id"),u,f,l,c,h;e.dateView=u=new n.DateView(j({},i,{id:o,anchor:e.wrapper,change:function(){var t=u.calendar.value(),n=+t,r=+i.min,s=+i.max,o;if(n===r||n===s)o=new _(e._value),o.setFullYear(t.getFullYear()),o.setMonth(t.getMonth()),o.setDate(t.getDate()),a(o,r,s)&&(t=o);e._change(t),e.close("date")},close:function(n){e.trigger(v,H)?n.preventDefault():(t.attr(A,!1),l.attr(O,!0),f.popup.visible()||t.removeAttr(M))},open:function(n){e.trigger(d,H)?n.preventDefault():(h=s(t.val(),i.parseFormats,i.culture),h?(e.dateView._current=h,e.dateView.calendar._focus(h)):e.dateView.value(h),l.attr(O,!1),t.attr(A,!0).attr(M,u._dateViewID))}})),l=u.div,e.timeView=f=new r({id:o,value:i.value,anchor:e.wrapper,animation:i.animation,dates:i.dates,format:i.timeFormat,culture:i.culture,height:i.height,interval:i.interval,min:new _(D),max:new _(P),parseFormats:i.parseFormats,change:function(r,s){r=f._parse(r),r<i.min?(r=new _(i.min),f.options.min=r):r>i.max&&(r=new _(i.max),f.options.max=r),s?(e._timeSelected=!0,e._change(r)):(t.val(n.toString(r,i.format,i.culture)),u.value(r),e._updateARIA(r))},close:function(n){e.trigger(v,B)?n.preventDefault():(c.attr(O,!0),t.attr(A,!1),u.popup.visible()||t.removeAttr(M))},open:function(n){e.trigger(d,B)?n.preventDefault():(c.attr(O,!1),t.attr(A,!0).attr(M,f._timeViewID))},active:function(e){t.removeAttr(L),e&&t.attr(L,f._optionID)}}),c=f.ul},_icons:function(){var t=this,n=t.element,r;r=n.next("span.k-select"),r[0]||(r=e('<span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-calendar">select</span><span unselectable="on" class="k-icon k-i-clock">select</span></span>').insertAfter(n)),r=r.children(),t._dateIcon=r.eq(0).attr({role:"button","aria-controls":t.dateView._dateViewID}),t._timeIcon=r.eq(1).attr({role:"button","aria-controls":t.timeView._timeViewID})},_wrapper:function(){var t=this,n=t.element,r;r=n.parents(".k-datetimepicker"),r[0]||(r=n.wrap(k).parent().addClass("k-picker-wrap k-state-default"),r=r.wrap(k).parent()),r[0].style.cssText=n[0].style.cssText,n.css({width:"100%",height:n[0].style.height}),t.wrapper=r.addClass("k-widget k-datetimepicker k-header").addClass(n[0].className),t._inputWrapper=e(r[0].firstChild)},_reset:function(){var e=this,t=e.element,n=t.closest("form");n[0]&&(e._resetHandler=function(){e.value(t[0].defaultValue)},e._form=n.on("reset",e._resetHandler))},_template:function(){this._ariaTemplate=n.template(this.options.ARIATemplate)},_updateARIA:function(e){this.element.attr("aria-label",this._ariaTemplate({current:e}))}});h.plugin(F)})(jQuery);