/*
* Kendo UI Beta v2012.3.1024 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Beta license terms available at
* http://www.kendoui.com/purchase/license-agreement/kendo-ui-beta.aspx
*/

;(function(e,t){function T(t){t.preventDefault();var n=e(t.currentTarget),r=n.closest(".k-widget").parent();r[0]||(r=n.parent()),r.trigger(e.Event(t.type,{target:n}))}function N(e,t){var n=e.x.location,r=e.y.location,i=t.x.location,s=t.y.location,o=n-i,u=r-s;return{center:{x:(n+i)/2,y:(r+s)/2},distance:Math.sqrt(o*o+u*u)}}function C(e){var t=[],n=e.originalEvent,r=0,s,o,u;if(e.api)t.push({id:2,event:e,target:e.target,location:e});else if(e.type.match(/touch/)){o=n?n.changedTouches:[];for(s=o.length;r<s;r++)u=o[r],t.push({location:u,event:e,target:u.target,id:u.identifier})}else i.pointers?t.push({location:n,event:e,target:e.target,id:n.pointerId}):t.push({id:1,event:e,target:e.target,location:e});return t}var n=window.kendo,r=n.EventProxy,i=n.support,s=i.pointers,o=window.document,u=e(o.documentElement),a=n.Class,f=n.Observable,l=e.now,c=e.extend,h=i.mobileOS,p=h&&h.android,d="press",v="start",m="move",g="end",y="cancel",b="tap",w="gesturestart",E="gesturechange",S="gestureend",x="gesturetap",k=a.extend({init:function(e,t){var n=this;n.axis=e,n._updateLocationData(t),n.startLocation=n.location,n.velocity=n.delta=0,n.timeStamp=l()},move:function(e){var t=this,n=e["page"+t.axis],r=l(),i=r-t.timeStamp||1;if(!n&&p)return;t.delta=n-t.location,t._updateLocationData(e),t.initialDelta=n-t.startLocation,t.velocity=t.delta/i,t.timeStamp=r},_updateLocationData:function(e){var t=this,n=t.axis;t.location=e["page"+n],t.client=e["client"+n],t.screen=e["screen"+n]}}),L=a.extend({init:function(e,t,n){var r=this;c(r,{x:new k("X",n.location),y:new k("Y",n.location),userEvents:e,target:t,currentTarget:n.currentTarget,id:n.id,_moved:!1,_finished:!1}),r._trigger(d,n)},move:function(e){var t=this;if(t._finished)return;t.x.move(e.location),t.y.move(e.location);if(!t._moved){if(t._withinIgnoreThreshold())return;if(!!A.current&&A.current!==t.userEvents)return t.dispose();t._start(e)}t._finished||t._trigger(m,e)},end:function(e){var t=this;t.endTime=l();if(t._finished)return;t._moved?t._trigger(g,e):t._trigger(b,e),t.dispose()},dispose:function(){var t=this,n=t.userEvents,r=n.touches;t._finished=!0,r.splice(e.inArray(t,r),1)},skip:function(){this.dispose()},cancel:function(){this.dispose()},isMoved:function(){return this._moved},_start:function(e){this.startTime=l(),this._moved=!0,this._trigger(v,e)},_trigger:function(e,t){var n=this,r=t.event,i={touch:n,x:n.x,y:n.y,target:n.target,event:r};n.userEvents.notify(e,i)&&r.preventDefault()},_withinIgnoreThreshold:function(){var e=this.x.initialDelta,t=this.y.initialDelta;return Math.sqrt(e*e+t*t)<=this.userEvents.threshold}}),A=f.extend({init:function(t,o){var a=this,l,h,p;o=o||{},l=a.filter=o.filter,a.threshold=o.threshold||0,a.touches=[],a._maxTouches=o.multiTouch?2:1,t=e(t),f.fn.init.call(a),c(a,{element:t,surface:o.global?u:o.surface||t,stopPropagation:o.stopPropagation,pressed:!1}),a.surfaceProxy=h=new r(a.surface,a),h.on("move","_move"),h.on("up cancel","_end"),a.elementProxy=p=new r(t,a),p.on("down",l,"_start"),s&&t.css("-ms-touch-action","pinch-zoom double-tap-zoom"),o.preventDragEvent&&p.on("dragstart",n.preventDefault),o.allowSelection||p.on("mousedown selectstart",l,T);if(i.eventCapture){var N=r.eventMap.up.split(" "),C=0,k=N.length,L=a.surface[0],A=function(e){a._isMoved()&&e.preventDefault()};for(;C<k;C++)L.addEventListener(N[C],A,!0)}a.bind([d,b,v,m,g,y,w,E,S,x],o)},destroy:function(){this.elementProxy.off(),this.surfaceProxy.off(),this._disposeAll()},capture:function(){A.current=this},cancel:function(){this._disposeAll(),this.trigger(y)},notify:function(t,n){var r=this,i=r.touches;if(this._isMultiTouch()){switch(t){case m:t=E;break;case g:t=S;break;case b:t=x}e.extend(n,{touches:i},N(i[0],i[1]))}return this.trigger(t,n)},press:function(e,t,n){this._apiCall("_start",e,t,n)},move:function(e,t){this._apiCall("_move",e,t)},end:function(e,t){this._apiCall("_end",e,t)},_isMultiTouch:function(){return this.touches.length>1},_maxTouchesReached:function(){return this.touches.length>=this._maxTouches},_disposeAll:function(){e.each(this.touches,function(){this.dispose()})},_isMoved:function(){return e.grep(this.touches,function(e){return e.isMoved()}).length},_isPressed:function(){return this.touches.length},_start:function(t){var n=this,r=0,i=n.filter,s,o=C(t),u=o.length,a;if(n._maxTouchesReached())return;A.current=null,n.currentTarget=t.currentTarget,n.stopPropagation&&t.stopPropagation();for(;r<u;r++){if(n._maxTouchesReached())break;a=o[r],s=e(a.target),i?s=s.is(i)?s:s.closest(i):s=n.element;if(!s.length)continue;n.touches.push(new L(n,s,a)),n._isMultiTouch()&&n.notify("gesturestart",{})}},_move:function(e){this._eachTouch("move",e)},_end:function(e){this._eachTouch("end",e)},_eachTouch:function(e,t){var n=this,r={},i=C(t),s=n.touches,o,u,a,f;for(o=0;o<s.length;o++)u=s[o],r[u.id]=u;for(o=0;o<i.length;o++)a=i[o],f=r[a.id],f&&f[e](a)},_apiCall:function(t,n,r,i){this[t]({api:!0,pageX:n,pageY:r,target:i||this.element,stopPropagation:e.noop,preventDefault:e.noop})}});n.getTouches=C,n.touchDelta=N,n.UserEvents=A})(jQuery);