/*
* Kendo UI Beta v2012.3.1024 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Beta license terms available at
* http://www.kendoui.com/purchase/license-agreement/kendo-ui-beta.aspx
*/

;(function(e,t){function et(t){t=e(t),t.children(v).children(".k-icon").remove(),t.filter(":has(.k-panel),:has(.k-content)").children(".k-link:not(:has([class*=k-i-arrow]))").each(function(){var t=e(this),n=t.parent();t.append("<span class='k-icon "+(n.hasClass(_)?"k-i-arrow-n k-panelbar-collapse":"k-i-arrow-s k-panelbar-expand")+"'/>")})}function tt(t){t=e(t),t.filter(".k-first:not(:first-child)").removeClass(S),t.filter(".k-last:not(:last-child)").removeClass(p),t.filter(":first-child").addClass(S),t.filter(":last-child").addClass(p)}var n=window.kendo,r=n.ui,i=n.keys,s=e.extend,o=e.each,u=n.template,a=r.Widget,f=/^(ul|a|div)$/i,l=".kendoPanelBar",c="img",h="href",p="k-last",d="k-link",v="."+d,m="error",g="click",y=".k-item",b=".k-group",w=b+":visible",E="k-image",S="k-first",x="expand",T="select",N="k-content",C="activate",k="collapse",L="contentUrl",A="mouseenter",O="mouseleave",M="contentLoad",_="k-state-active",D="> .k-panel",P="> .k-content",H="k-state-focused",B="k-state-disabled",j="k-state-selected",F="."+j,I="k-state-highlighted",q=y+":not(.k-state-disabled)",R=q+" > .k-link",U=y+".k-state-disabled > .k-link",z="> li > "+F+", .k-panel > li > "+F,W="k-state-default",X="aria-disabled",V="aria-expanded",$="aria-hidden",J="aria-selected",K=":visible",Q=":empty",G="single",Y={content:u("<div role='region' class='k-content'#= contentAttributes(data) #>#= content(item) #</div>"),group:u("<ul role='group' aria-hidden='true' class='#= groupCssClass(group) #'#= groupAttributes(group) #>#= renderItems(data) #</ul>"),itemWrapper:u("<#= tag(item) # class='#= textClass(item, group) #' #= contentUrl(item) ##= textAttributes(item) #>#= image(item) ##= sprite(item) ##= text(item) ##= arrow(data) #</#= tag(item) #>"),item:u("<li role='menuitem' #=aria(item)#class='#= wrapperCssClass(group, item) #'>#= itemWrapper(data) ## if (item.items) { ##= subGroup({ items: item.items, panelBar: panelBar, group: { expanded: item.expanded } }) ## } #</li>"),image:u("<img class='k-image' alt='' src='#= imageUrl #' />"),arrow:u("<span class='#= arrowClass(item) #'></span>"),sprite:u("<span class='k-sprite #= spriteCssClass #'></span>"),empty:u("")},Z={aria:function(e){var t="";if(e.items||e.content||e.contentUrl)t+=V+"='"+(e.expanded?"true":"false")+"' ";return e.enabled===!1&&(t+=X+"='true'"),t},wrapperCssClass:function(e,t){var n="k-item",r=t.index;return t.enabled===!1?n+=" "+B:t.expanded===!0?n+=" "+_:n+=" k-state-default",r===0&&(n+=" k-first"),r==e.length-1&&(n+=" k-last"),n},textClass:function(e,t){var n=d;return t.firstLevel&&(n+=" k-header"),n},textAttributes:function(e){return e.url?" href='"+e.url+"'":""},arrowClass:function(e){var t="k-icon";return t+=e.expanded?" k-i-arrow-n k-panelbar-collapse":" k-i-arrow-s k-panelbar-expand",t},text:function(e){return e.encoded===!1?e.text:n.htmlEncode(e.text)},tag:function(e){return e.url?"a":"span"},groupAttributes:function(e){return e.expanded!==!0?" style='display:none'":""},groupCssClass:function(e){return"k-group k-panel"},contentAttributes:function(e){return e.item.expanded!==!0?" style='display:none'":""},content:function(e){return e.content?e.content:e.contentUrl?"":"&nbsp;"},contentUrl:function(e){return e.contentUrl?n.attr("content-url")+'="'+e.contentUrl+'"':""}},nt=a.extend({init:function(t,r){var i=this,s;a.fn.init.call(i,t,r),t=i.wrapper=i.element.addClass("k-widget k-reset k-header k-panelbar"),r=i.options,r.dataSource&&(i.element.empty(),i.append(r.dataSource,t)),t[0].id&&(i._itemId=t[0].id+"_pb_active"),i._tabindex(),i._updateClasses(),r.animation===!1&&(r.animation={expand:{show:!0,effects:{}},collapse:{hide:!0,effects:{}}}),t.on(g+l,R,function(t){i._click(e(t.currentTarget))&&t.preventDefault()}).on(A+l+" "+O+l,R,i._toggleHover).on(g+l,U,!1).on("keydown"+l,e.proxy(i._keydown,i)).on("focus"+l,function(){var e=i.select();i._current(e[0]?e:i._first())}).on("blur"+l,function(){i._current(null)}).attr("role","menu"),r.contentUrls&&t.find("> .k-item").each(function(t,n){e(n).find(v).data(L,r.contentUrls[t])}),s=t.find("li."+_+" > ."+N),s[0]&&i.expand(s.parent(),!1),n.notify(i)},events:[x,k,T,C,m,M],options:{name:"PanelBar",animation:{expand:{effects:"expand:vertical",duration:200,show:!0},collapse:{duration:200}},expandMode:"multiple"},destroy:function(){a.fn.destroy.call(this),this.element.off(l),n.destroy(this.element)},expand:function(t,n){var r=this,i={};return n=n!==!1,t=this.element.find(t),t.each(function(s,o){o=e(o);var u=o.find(D).add(o.find(P));if(!o.hasClass(B)&&u.length>0){if(r.options.expandMode==G&&r._collapseAllExpanded(o))return r;t.find("."+I).removeClass(I),o.addClass(I),n||(i=r.options.animation,r.options.animation={expand:{show:!0,effects:{}},collapse:{hide:!0,effects:{}}}),r._triggerEvent(x,o)||r._toggleItem(o,!1),n||(r.options.animation=i)}}),r},collapse:function(t,n){var r=this,i={};return n=n!==!1,t=r.element.find(t),t.each(function(t,s){s=e(s);var o=s.find(D).add(s.find(P));!s.hasClass(B)&&o.is(K)&&(s.removeClass(I),n||(i=r.options.animation,r.options.animation={expand:{show:!0,effects:{}},collapse:{hide:!0,effects:{}}}),r._triggerEvent(k,s)||r._toggleItem(s,!0),n||(r.options.animation=i))}),r},_toggleDisabled:function(e,t){e=this.element.find(e),e.toggleClass(W,t).toggleClass(B,!t).attr(X,!t)},select:function(n){var r=this;return n===t?r.element.find(z).parent():(r.element.find(n).each(function(t){var n=e(this),i=n.children(v);if(n.hasClass(B))return r;r._updateSelected(i)}),r)},enable:function(e,t){return this._toggleDisabled(e,t!==!1),this},disable:function(e){return this._toggleDisabled(e,!1),this},append:function(t,n){n=this.element.find(n);var r=this._insert(t,n,n.length?n.find(D):null);return o(r.items,function(t){r.group.append(this);var n=r.contents[t];n&&e(this).append(n),tt(this)}),et(n),tt(r.group.find(".k-first, .k-last")),r.group.height("auto"),this},insertBefore:function(t,n){n=this.element.find(n);var r=this._insert(t,n,n.parent());return o(r.items,function(t){n.before(this);var i=r.contents[t];i&&e(this).append(i),tt(this)}),tt(n),r.group.height("auto"),this},insertAfter:function(t,n){n=this.element.find(n);var r=this._insert(t,n,n.parent());return o(r.items,function(t){n.after(this);var i=r.contents[t];i&&e(this).append(i),tt(this)}),tt(n),r.group.height("auto"),this},remove:function(e){e=this.element.find(e);var t=this,n=e.parentsUntil(t.element,y),r=e.parent("ul");return e.remove(),r&&!r.hasClass("k-panelbar")&&!r.children(y).length&&r.remove(),n.length&&(n=n.eq(0),et(n),tt(n)),t},reload:function(t){var n=this;t=n.element.find(t),t.each(function(){var t=e(this);n._ajaxRequest(t,t.children("."+N),!t.is(K))})},_first:function(){return this.element.children(q).first()},_last:function(){var e=this.element.children(q).last(),t=e.children(w);return t[0]?t.children(q).last():e},_current:function(e){var n=this,r=n._focused;if(e===t)return r;n.element.removeAttr("aria-activedescendant"),r&&r.removeAttr("id").children(v).removeClass(H),e&&(e.attr("id",n._itemId).children(v).addClass(H),n.element.attr("aria-activedescendant",n._itemId)),n._focused=e},_keydown:function(e){var t=this,n=e.keyCode,r=t._current();if(e.target!=e.currentTarget)return;n==i.DOWN||n==i.RIGHT?(t._current(t._nextItem(r)),e.preventDefault()):n==i.UP||n==i.LEFT?(t._current(t._prevItem(r)),e.preventDefault()):n==i.ENTER||n==i.SPACEBAR?(t._click(r.children(v)),e.preventDefault()):n==i.HOME?(t._current(t._first()),e.preventDefault()):n==i.END&&(t._current(t._last()),e.preventDefault())},_nextItem:function(e){if(!e)return this._first();var t=e.children(w),n=e.next();t[0]&&(n=t.children("."+S)),n[0]||(n=e.parent(w).parent(y).next());if(!n[0]||!n.is(":visible"))n=this._first();return n.hasClass(B)&&(n=this._nextItem(n)),n},_prevItem:function(e){if(!e)return this._last();var t=e.prev(),n;if(!t[0])t=e.parent(w).parent(y),t[0]||(t=this._last());else{n=t;while(n[0])n=n.children(w).children("."+p),n[0]&&(t=n)}return t.hasClass(B)&&(t=this._prevItem(t)),t},_insert:function(t,n,r){var i=this,o,u=[],a=e.isPlainObject(t),f=n&&n[0],l;return f||(r=i.element),l={firstLevel:r.hasClass("k-panelbar"),expanded:r.parent().hasClass(_),length:r.children().length},f&&!r.length&&(r=e(nt.renderGroup({group:l})).appendTo(n)),a||e.isArray(t)?(o=e.map(a?[t]:t,function(t,n){return typeof t=="string"?e(t):e(nt.renderItem({group:l,item:s(t,{index:n})}))}),u=e.map(a?[t]:t,function(t,n){return t.content||t.contentUrl?e(nt.renderContent({item:s(t,{index:n})})):!1}),f&&n.attr(V,!1)):(o=e(t),i._updateItemsClasses(o)),{items:o,group:r,contents:u}},_toggleHover:function(t){var n=e(t.currentTarget);n.parents("li."+B).length||n.toggleClass("k-state-hover",t.type==A)},_updateClasses:function(){var t=this,n,r;n=t.element.find("li > ul").not(function(){return e(this).parentsUntil(".k-panelbar","div").length}).addClass("k-group k-panel").attr("role","group"),n.parent().attr(V,!1).not("."+_).children("ul").attr($,!0).hide(),r=t.element.add(n).children(),t._updateItemsClasses(r),et(r),tt(r)},_updateItemsClasses:function(e){var t=e.length,n=0;for(;n<t;n++)this._updateItemClasses(e[n])},_updateItemClasses:function(t){var n=this._selected,r;t=e(t).addClass("k-item").attr("role","menuitem"),t.children(c).addClass(E),t.children("a").addClass(d).children(c).addClass(E),t.filter(":not([disabled]):not([class*=k-state])").addClass("k-state-default"),t.filter("li[disabled]").addClass("k-state-disabled").attr(X,!0).removeAttr("disabled"),t.children("div").addClass(N).attr("role","region").attr($,!0).hide().parent().attr(V,!1),r=t.children(F),r[0]&&(n&&n.removeAttr(J).children(F).removeClass(j),r.addClass(j),this._selected=t.attr(J,!0)),t.children(v)[0]||t.contents().filter(function(){return!this.nodeName.match(f)&&(this.nodeType!=3||!!e.trim(this.nodeValue))}).wrapAll("<span class='"+d+"'/>"),t.parent(".k-panelbar")[0]&&t.children(v).addClass("k-header")},_click:function(e){var t=this,n=t.element,r;if(e.parents("li."+B).length)return;if(e.closest(".k-widget")[0]!=n[0])return;var i=e.closest(v),s=i.closest(y);t._updateSelected(i);var o=s.find(D).add(s.find(P)),u=i.attr(h),a=i.data(L)||u&&(u.charAt(u.length-1)=="#"||u.indexOf("#"+t.element[0].id+"-")!=-1);if(o.data("animating"))return;t._triggerEvent(T,s)&&(r=!0);if(!a&&!o.length)return;r=!0;if(t.options.expandMode==G&&t._collapseAllExpanded(s))return;if(o.length){var f=o.is(K);t._triggerEvent(f?k:x,s)||(r=t._toggleItem(s,f))}return r},_toggleItem:function(e,t){var n=this,r=e.find(D),i,s;return r.length?(this._toggleGroup(r,t),i=!0):(s=e.children("."+N),s.length&&(i=!0,s.is(Q)?n._ajaxRequest(e,s,t):n._toggleGroup(s,t))),i},_toggleGroup:function(e,t){var n=this,r=n.options.animation,i=r.expand,o=s({},r.collapse),u=o&&"effects"in o;if(e.is(K)!=t)return;e.parent().attr(V,!t).attr($,t).toggleClass(W,t).toggleClass(_,!t).find("> .k-link > .k-icon").toggleClass("k-i-arrow-n",!t).toggleClass("k-panelbar-collapse",!t).toggleClass("k-i-arrow-s",t).toggleClass("k-panelbar-expand",t),t?i=s(u?o:s({reverse:!0},i),{show:!1,hide:!0}):i=s({complete:function(e){n._triggerEvent(C,e.closest(y))}},i),e.kendoStop(!0,!0).kendoAnimate(i)},_collapseAllExpanded:function(t){var n=this,r,i=!1;if(t.children(v).hasClass("k-header")){var s=t.find(D).add(t.find(P));return s.is(K)&&(i=!0),!s.is(K)&&s.length!==0&&(r=e(n.element).children(),r.find(D).add(r.find(P)).filter(function(){return e(this).is(K)}).each(function(t,r){r=e(r),i=n._triggerEvent(k,r.closest(y)),i||n._toggleGroup(r,!0)})),i}},_ajaxRequest:function(t,n,r){var i=this,s=t.find(".k-panelbar-collapse, .k-panelbar-expand"),o=t.find(v),u=setTimeout(function(){s.addClass("k-loading")},100),a={};e.ajax({type:"GET",cache:!1,url:o.data(L)||o.attr(h),dataType:"html",data:a,error:function(e,t){s.removeClass("k-loading"),i.trigger(m,{xhr:e,status:t})&&this.complete()},complete:function(){clearTimeout(u),s.removeClass("k-loading")},success:function(e,s){n.html(e),i._toggleGroup(n,r),i.trigger(M,{item:t[0],contentElement:n[0]})}})},_triggerEvent:function(e,t){var n=this;return n.trigger(e,{item:t[0]})},_updateSelected:function(e){var t=this,n=t.element,r=e.parent(y),i=t._selected;i&&i.removeAttr(J),t._selected=r.attr(J,!0),n.find(z).removeClass(j),n.find("> .k-state-highlighted, .k-panel > .k-state-highlighted").removeClass(I),e.addClass(j),e.parentsUntil(n,y).filter(":has(.k-header)").addClass(I),t._current(r)}});s(nt,{renderItem:function(e){e=s({panelBar:{},group:{}},e);var t=Y.empty,n=e.item;return Y.item(s(e,{image:n.imageUrl?Y.image:t,sprite:n.spriteCssClass?Y.sprite:t,itemWrapper:Y.itemWrapper,arrow:n.items||n.content||n.contentUrl?Y.arrow:t,subGroup:nt.renderGroup},Z))},renderGroup:function(e){return Y.group(s({renderItems:function(e){var t="",n=0,r=e.items,i=r?r.length:0,o=s({length:i},e.group);for(;n<i;n++)t+=nt.renderItem(s(e,{group:o,item:s({index:n},r[n])}));return t}},e,Z))},renderContent:function(e){return Y.content(s(e,Z))}}),n.ui.plugin(nt)})(jQuery);