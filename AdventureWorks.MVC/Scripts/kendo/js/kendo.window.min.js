/*
* Kendo UI Beta v2012.3.1024 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Beta license terms available at
* http://www.kendoui.com/purchase/license-agreement/kendo-ui-beta.aspx
*/

;(function(e,t){function q(e){return typeof e!="undefined"}function R(e,t,n){return Math.max(Math.min(e,n),t)}function U(e,t){var n=e.children(m);return n.data("kendoWindow")||n.data("kendo"+t)}function z(t){return e(p).filter(function(){var n=e(this);return n.is(x)&&U(n,t).options.modal}).sort(function(t,n){return+e(t).css("zIndex")- +e(n).css("zIndex")})}function W(e,t){return function(){var e=this,n=e.wrapper,r=n[0].style,i=e.options;if(i.isMaximized||i.isMinimized)return;return e.restoreOptions={width:r.width,height:r.height},n.find(g).hide().end().find(j).parent().hide().eq(0).before(c.action({name:"Restore"})),t.call(e),e}}function V(e){var t=this;t.owner=e,t._draggable=new i(e.wrapper,{filter:g,group:e.wrapper.id+"-resizing",dragstart:o(t.dragstart,t),drag:o(t.drag,t),dragend:o(t.dragend,t)})}function $(e){var t=this;t.owner=e,t._draggable=new i(e.wrapper,{filter:v,group:e.wrapper.id+"-moving",dragstart:o(t.dragstart,t),drag:o(t.drag,t),dragend:o(t.dragend,t),dragcancel:o(t.dragcancel,t)})}var n=window.kendo,r=n.ui.Widget,i=n.ui.Draggable,s=e.isPlainObject,o=e.proxy,u=e.extend,a=e.each,f=n.template,l="body",c,h=".kendoWindow",p=".k-window",d=".k-window-title",v=d+"bar",m=".k-window-content",g=".k-resize-handle",y=".k-overlay",b="k-content-frame",w="k-loading",E="k-state-hover",S="k-state-focused",x=":visible",T="hidden",N="cursor",C="open",k="activate",L="deactivate",A="close",O="refresh",M="resize",_="dragstart",D="dragend",P="error",H="overflow",B="zIndex",j=".k-window-actions .k-i-minimize,.k-window-actions .k-i-maximize",F=".k-window-titlebar .k-window-action",I=n.isLocalUrl,X=r.extend({init:function(t,i){var u=this,f,l,g,y,b=!1,w,N,L;r.fn.init.call(u,t,i),i=u.options,t=u.element,w=i.content,u.appendTo=e(i.appendTo||document.body),u._animations(),w&&!s(w)&&(w=i.content={url:w}),t.parent().is(u.appendTo)||(t.is(x)?(l=t.offset(),b=!0):(g=t.css("visibility"),y=t.css("display"),t.css({visibility:T,display:""}),l=t.offset(),t.css({visibility:g,display:y}))),q(i.visible)||(i.visible=t.is(x)),f=u.wrapper=t.closest(p);if(!t.is(".k-content")||!f[0])t.addClass("k-window-content k-content"),u._createWindow(t,i),f=u.wrapper=t.closest(p),u._dimensions();l&&f.css({top:l.top,left:l.left}),w&&u.refresh(w),u.toFront(),N=f.children(m),u._tabindex(N),i.visible&&i.modal&&u._overlay(f.is(x)).css({opacity:.5}),f.on("mouseenter"+h,F,function(){e(this).addClass(E)}).on("mouseleave"+h,F,function(){e(this).removeClass(E)}).on("click"+h,F,o(u._windowActionHandler,u)),N.on("keydown"+h,o(u._keydown,u)).on("focus"+h,function(){f.addClass(S)}).on("blur"+h,function(){f.removeClass(S)}),i.resizable&&(f.on("dblclick"+h,v,o(u.toggleMaximization,u)),a("n e s w se sw ne nw".split(" "),function(e,t){f.append(c.resizeHandle(t))}),u.resizing=new V(u)),i.draggable&&(u.dragging=new $(u)),L=t.attr("id"),L&&(L+="_wnd_title",f.find(v).children(d).attr("id",L),N.attr({role:"dialog","aria-labelledby":L})),f.add(f.find(".k-resize-handle,.k-window-titlebar")).on("mousedown"+h,o(u.toFront,u)),u.touchScroller=n.touchScroller(t),u._resizeHandler=function(e){return u._onDocumentResize(e)},e(window).on("resize",u._resizeHandler),i.visible&&(u.trigger(C),u.trigger(k)),n.notify(u)},_dimensions:function(){var e=this,t=e.wrapper,n=e.element,r=e.options;e.title(r.title),r.width&&t.width(r.width),r.height&&t.height(r.height),a(["minWidth","minHeight","maxWidth","maxHeight"],function(e,t){var i=r[t];i&&i!=Infinity&&n.css(t,i)}),r.visible||t.hide()},_animations:function(){var e=this.options;e.animation===!1&&(e.animation={open:{show:!0,effects:{}},close:{hide:!0,effects:{}}})},setOptions:function(e){r.fn.setOptions.call(this,e),this._animations(),this._dimensions()},events:[C,k,L,A,O,M,_,D,P],options:{name:"Window",animation:{open:{effects:{zoom:{direction:"in"},fade:{direction:"in"}},duration:350,show:!0},close:{effects:{zoom:{direction:"out",properties:{scale:.7}},fade:{direction:"out"}},duration:350,hide:!0}},title:"",actions:["Close"],modal:!1,resizable:!0,draggable:!0,minWidth:90,minHeight:50,maxWidth:Infinity,maxHeight:Infinity},_keydown:function(e){var t=this,r=t.options,i=n.keys,s=e.keyCode,o=t.wrapper,u,a,f=10,l,c;if(e.target!=e.currentTarget)return;s==i.ESC&&t._close(!0),r.draggable&&!e.ctrlKey&&(u=o.offset(),s==i.UP?a=o.css("top",u.top-f):s==i.DOWN?a=o.css("top",u.top+f):s==i.LEFT?a=o.css("left",u.left-f):s==i.RIGHT&&(a=o.css("left",u.left+f))),r.resizable&&e.ctrlKey&&(s==i.UP?(a=!0,c=o.height()-f):s==i.DOWN&&(a=!0,c=o.height()+f),s==i.LEFT?(a=!0,l=o.width()-f):s==i.RIGHT&&(a=!0,l=o.width()+f),a&&o.css({width:R(l,r.minWidth,r.maxWidth),height:R(c,r.minHeight,r.maxHeight)})),a&&e.preventDefault()},_overlay:function(t){var n=this.appendTo.children(".k-overlay"),r=this.wrapper;return n.length||(n=e("<div class='k-overlay' />")),n.insertBefore(r[0]).toggle(t).css(B,parseInt(r.css(B),10)-1),n},_windowActionHandler:function(t){var n=e(t.target).closest(".k-window-action").find(".k-icon"),r=this;a({"k-i-close":function(){r._close(!0)},"k-i-maximize":r.maximize,"k-i-minimize":r.minimize,"k-i-restore":r.restore,"k-i-refresh":r.refresh},function(e,i){if(n.hasClass(e))return t.preventDefault(),i.call(r),!1})},center:function(){var t=this.wrapper,n=e(window);return t.css({left:n.scrollLeft()+Math.max(0,(n.width()-t.width())/2),top:n.scrollTop()+Math.max(0,(n.height()-t.height())/2)}),this},title:function(e){var t=this,n=t.wrapper,r=t.options,i=n.find(v),s=i.children(d),o=i.outerHeight();return arguments.length?(e===!1?(n.addClass("k-window-titleless"),i.remove()):(i.length||n.prepend(c.titlebar(u(c,r))),n.css("padding-top",o),i.css("margin-top",-o)),s.text(e),t):s.text()},content:function(e){var t=this.wrapper.children(m);return e?(t.html(e),this):t.html()},open:function(){var t=this,n=t.wrapper,r=t.options,i=r.animation.open,s=n.children(m),o=s.css(H),u;return t.trigger(C)||(t.toFront(),r.visible=!0,r.modal&&(u=t._overlay(!1),i.duration?u.kendoStop().kendoAnimate({effects:{fade:{direction:"in",properties:{opacity:.5}}},duration:i.duration,show:!0}):u.css("opacity",.5).show()),n.is(x)||(s.css(H,T),n.show().kendoStop().kendoAnimate({effects:i.effects,duration:i.duration,complete:function(){t.element.focus(),t.trigger(k),s.css(H,o)}}))),r.isMaximized&&(t._documentScrollTop=e(document).scrollTop(),e("html, body").css(H,T)),t},_close:function(n){var r=this,i=r.wrapper,s=r.options,o=s.animation.open,u=s.animation.close,a,f,l;i.is(x)&&!r.trigger(A,{userTriggered:!!n})&&(s.visible=!1,a=z(s.name),f=s.modal&&a.length==1&&a[0]==r.wrapper[0],l=s.modal?r._overlay(!0):e(t),f?u.duration?l.kendoStop().kendoAnimate({effects:"fade:out",duration:u.duration,hide:!0}):l.hide():a.length&&U(a.eq(a.length-2),s.name)._overlay(!0),i.kendoStop().kendoAnimate({effects:u.effects||o.effects,reverse:u.reverse===!0,duration:u.duration,complete:function(){i.hide(),r.trigger(L)}})),r.options.isMaximized&&(e("html, body").css(H,""),r._documentScrollTop&&r._documentScrollTop>0&&e(document).scrollTop(r._documentScrollTop))},close:function(){return this._close(!1),this},toFront:function(){var t=this,n=t.wrapper,r=n[0],i=+n.css(B),s=i;e(p).each(function(t,n){var s=e(n),o=s.css(B),u=s.find(m);isNaN(o)||(i=Math.max(+o,i)),n!=r&&u.find("> ."+b).length>0&&u.append(c.overlay)});if(i==10001||s<i)n.css(B,i+2),t.element.find("> .k-overlay").remove();return t.element.focus(),t},toggleMaximization:function(){return this[this.options.isMaximized?"restore":"maximize"]()},restore:function(){var t=this,n=t.options,r=t.restoreOptions;if(!n.isMaximized&&!n.isMinimized)return;return t.wrapper.css({position:"absolute",left:r.left,top:r.top,width:r.width,height:r.height}).find(".k-window-content,.k-resize-handle").show().end().find(".k-window-titlebar .k-i-restore").parent().remove().end().end().find(j).parent().show(),e("html, body").css(H,""),this._documentScrollTop&&this._documentScrollTop>0&&e(document).scrollTop(this._documentScrollTop),n.isMaximized=n.isMinimized=!1,t.trigger(M),t},maximize:W("maximize",function(){var t=this,n=t.wrapper,r=n.position();u(t.restoreOptions,{left:r.left,top:r.top}),n.css({left:0,top:0,position:"fixed"}),this._documentScrollTop=e(document).scrollTop(),e("html, body").css(H,T),t.options.isMaximized=!0,t._onDocumentResize()}),minimize:W("minimize",function(){var e=this;e.wrapper.css("height",""),e.element.hide(),e.options.isMinimized=!0}),_onDocumentResize:function(){var t=this,n=t.wrapper,r=e(window);if(!t.options.isMaximized)return;n.css({width:r.width(),height:r.height()-parseInt(n.css("padding-top"),10)}),t.trigger(M)},refresh:function(t){var n=this,r=n.options,i=e(n.element),o,a,l;return s(t)||(t={url:t}),t=u({},r.content,t),a=q(r.iframe)?r.iframe:t.iframe,l=t.url,l?(q(a)||(a=!I(l)),a?(o=i.find("."+b)[0],o?o.src=l||o.src:i.html(c.contentFrame(u({},r,{content:t}))),i.find("."+b).unbind("load"+h).on("load"+h,function(){n.trigger(O)})):n._ajaxRequest(t)):(t.template&&n.content(f(t.template)({})),n.trigger(O)),n},_ajaxRequest:function(t){var n=this,r=t.template,i=n.wrapper.find(".k-window-titlebar .k-i-refresh"),s=setTimeout(function(){i.addClass(w)},100);e.ajax(u({type:"GET",dataType:"html",cache:!1,error:o(function(e,t){n.trigger(P,{status:t,xhr:e})},n),complete:function(){clearTimeout(s),i.removeClass(w)},success:o(function(e,t){r&&(e=f(r)(e||{})),n.element.html(e),n.trigger(O)},n)},t))},destroy:function(){var t=this,i,s;r.fn.destroy.call(t),n.destroy(t.wrapper),t.resizing&&t.resizing.destroy(),t.dragging&&t.dragging.destroy(),t.wrapper.remove().add(t.wrapper.find(".k-resize-handle,.k-window-titlebar")).off(h),e(window).off("resize",t._resizeHandler),i=z(),s=t.options.modal&&!i.length,s?t._overlay(!1).remove():i.length>0&&U(i.eq(i.length-2),t.options.name)._overlay(!0)},_createWindow:function(){var t=this,r=t.element,i=t.options,s,o,a=n.support.isRtl(r);i.scrollable===!1&&r.attr("style","overflow:hidden;"),i.iframe&&i.content&&r.html(c.contentFrame(i)),o=e(c.wrapper(i)),i.title!==!1&&o.append(c.titlebar(u(c,i))),s=r.find("iframe:not(.k-content)").map(function(e){var t=this.getAttribute("src");return this.src="",t}),o.toggleClass("k-rtl",a).appendTo(t.appendTo).append(r).find("iframe:not(.k-content)").each(function(e){this.src=s[e]}),o.find(".k-window-title").css(a?"left":"right",o.find(".k-window-actions").outerWidth()+10),r.show()}});c={wrapper:f("<div class='k-widget k-window' />"),action:f("<a role='button' href='\\#' class='k-window-action k-link'><span role='presentation' class='k-icon k-i-#= name.toLowerCase() #'>#= name #</span></a>"),titlebar:f("<div class='k-window-titlebar k-header'>&nbsp;<span class='k-window-title'>#= title #</span><div class='k-window-actions'># for (var i = 0; i < actions.length; i++) { ##= action({ name: actions[i] }) ## } #</div></div>"),overlay:"<div class='k-overlay' />",contentFrame:f("<iframe frameborder='0' title='#= title #' class='"+b+"' "+"src='#= content.url #'>"+"This page requires frames in order to show content"+"</iframe>"),resizeHandle:f("<div class='k-resize-handle k-resize-#= data #'></div>")},V.prototype={dragstart:function(t){var n=this,r=n.owner,i=r.wrapper;n.elementPadding=parseInt(r.wrapper.css("padding-top"),10),n.initialCursorPosition=i.offset(),n.resizeDirection=t.currentTarget.prop("className").replace("k-resize-handle k-resize-",""),n.initialSize={width:i.width(),height:i.height()},n.containerOffset=r.appendTo.offset(),i.append(c.overlay).find(g).not(t.currentTarget).hide(),e(l).css(N,t.currentTarget.css(N))},drag:function(e){var t=this,n=t.owner,r=n.wrapper,i=n.options,s=t.resizeDirection,o=t.containerOffset,u=t.initialCursorPosition,a=t.initialSize,f,l,c,h,p=e.x.location,d=e.y.location;s.indexOf("e")>=0?(f=p-u.left,r.width(R(f,i.minWidth,i.maxWidth))):s.indexOf("w")>=0&&(h=u.left+a.width,f=R(h-p,i.minWidth,i.maxWidth),r.css({left:h-f-o.left,width:f})),s.indexOf("s")>=0?(l=d-u.top-t.elementPadding,r.height(R(l,i.minHeight,i.maxHeight))):s.indexOf("n")>=0&&(c=u.top+a.height,l=R(c-d,i.minHeight,i.maxHeight),r.css({top:c-l-o.top,height:l})),n.trigger(M)},dragend:function(t){var n=this,r=n.owner,i=r.wrapper;return i.find(y).remove().end().find(g).not(t.currentTarget).show(),e(l).css(N,""),r.touchScroller&&r.touchScroller.reset(),t.keyCode==27&&i.css(n.initialCursorPosition).css(n.initialSize),!1},destroy:function(){this._draggable.destroy()}},$.prototype={dragstart:function(t){var n=this.owner,r=n.element,i=r.find(".k-window-actions"),s=n.appendTo.offset();n.trigger(_),n.initialWindowPosition=n.wrapper.position(),n.startPosition={left:t.x.client-n.initialWindowPosition.left,top:t.y.client-n.initialWindowPosition.top},i.length>0?n.minLeftPosition=i.outerWidth()+parseInt(i.css("right"),10)-r.outerWidth():n.minLeftPosition=20-r.outerWidth(),n.minLeftPosition-=s.left,n.minTopPosition=-s.top,n.wrapper.append(c.overlay).find(g).hide(),e(l).css(N,t.currentTarget.css(N))},drag:function(t){var n=this.owner,r={left:Math.max(t.x.client-n.startPosition.left,n.minLeftPosition),top:Math.max(t.y.client-n.startPosition.top,n.minTopPosition)};e(n.wrapper).css(r)},_finishDrag:function(){var t=this.owner;t.wrapper.find(g).toggle(!t.options.isMinimized).end().find(y).remove(),e(l).css(N,"")},dragcancel:function(e){this._finishDrag(),e.currentTarget.closest(p).css(this.owner.initialWindowPosition)},dragend:function(e){return this._finishDrag(),this.owner.trigger(D),!1},destroy:function(){this._draggable.destroy()}},n.ui.plugin(X)})(jQuery);