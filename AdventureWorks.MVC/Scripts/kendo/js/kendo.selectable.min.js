/*
* Kendo UI Beta v2012.3.1024 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Beta license terms available at
* http://www.kendoui.com/purchase/license-agreement/kendo-ui-beta.aspx
*/

;(function(e,t){var n=window.kendo,r=n.support.touch,i=n.ui.Widget,s=e.proxy,o=r?"touchend":"mouseup",u=r?"touchstart":"mousedown",a=r?"touchmove":"mousemove",f="k-state-selected",l="k-state-selecting",c="k-selectable",h="selectstart",p=e(document),d="change",v=".kendoSelectable",m="k-state-unselecting",g=!1;(function(e){(function(){e('<div class="parent"><span /></div>').on("click",">*",function(){g=!0}).find("span").click()})()})(e);var y=i.extend({init:function(t,n){var r=this;i.fn.init.call(r,t,n),r._marquee=e("<div class='k-marquee'></div>"),r._lastActive=null,r._moveDelegate=s(r._move,r),r._upDelegate=s(r._up,r),r.element.addClass(c),r.element.on(u+v,(g?"":"."+c+" ")+r.options.filter,s(r._down,r))},events:[d],options:{name:"Selectable",filter:">*",multiple:!1},_collide:function(e,t){var n=e.offset(),r={left:n.left,top:n.top,right:n.left+e.outerWidth(),bottom:n.top+e.outerHeight()};return!(r.left>t.right||r.right<t.left||r.top>t.bottom||r.bottom<t.top)},_position:function(e){var t=this._originalPosition,n=t.x,r=t.y,i=e.pageX,s=e.pageY,o;return n>i&&(o=i,i=n,n=o),r>s&&(o=s,s=r,r=o),{top:r,right:i,left:n,bottom:s}},_down:function(t){var r=this,i,s=t.ctrlKey,u=t.shiftKey,d=!r.options.multiple;r._downTarget=e(t.currentTarget),r._shiftPressed=u;if(r._downTarget.closest("."+c)[0]!==r.element[0])return;p.unbind(o,r._upDelegate).bind(o,r._upDelegate),r._originalPosition={x:t.pageX,y:t.pageY},!d&&e(t.target).is(":not(:input, a)")&&(p.unbind(a,r._moveDelegate).bind(a,r._moveDelegate).unbind(h,!1).bind(h,!1),n.support.touch||t.preventDefault()),d||(e("body").append(r._marquee),r._marquee.css({left:t.clientX+1,top:t.clientY+1,width:0,height:0})),i=r._downTarget.hasClass(f),(d||!s&&!u)&&r.element.find(r.options.filter+"."+f).not(r._downTarget).removeClass(f),s&&(r._lastActive=r._downTarget);if(i&&(s||u))r._downTarget.addClass(f),u||r._downTarget.addClass(m);else if(!n.support.touch||!d)r._downTarget.addClass(l),d&&r._downTarget.hasClass(f)&&r._downTarget.removeClass(l)},_move:function(t){var n=this,r=n._position(t),i=t.ctrlKey,s,o;n._marquee.css({left:r.left,top:r.top,width:r.right-r.left,height:r.bottom-r.top}),n.element.find(n.options.filter).each(function(){s=e(this),o=n._collide(s,r),o?s.hasClass(f)?n._downTarget[0]!==s[0]&&i&&s.removeClass(f).addClass(m):!s.hasClass(l)&&!s.hasClass(m)&&s.addClass(l):s.hasClass(l)?s.removeClass(l):i&&s.hasClass(m)&&s.removeClass(m).addClass(f)})},_up:function(e){var t=this,r=t.options,i=!r.multiple;p.unbind(h,!1).unbind(a,t._moveDelegate).unbind(o,t._upDelegate),i||t._marquee.remove(),n.support.touch&&i&&t._downTarget.addClass(l),!i&&t._shiftPressed===!0?t.selectRange(t._firstSelectee(),t._downTarget):(t.element.find(r.filter+"."+m).removeClass(m).removeClass(f),t.value(t.element.find(r.filter+"."+l))),t._shiftPressed||(t._lastActive=t._downTarget),t._downTarget=null,t._shiftPressed=!1},value:function(e){var t=this,n=s(t._selectElement,t);if(e){e.each(function(){n(this)}),t.trigger(d,{});return}return t.element.find(t.options.filter+"."+f)},_firstSelectee:function(){var e=this,t;return e._lastActive!==null?e._lastActive:(t=e.value(),t.length>0?t[0]:e.element.find(e.options.filter))},_selectElement:function(t){var n=e(t),r=this.trigger("select",{element:t});n.removeClass(l),r||(n.addClass(f),this.options.aria&&n.attr("aria-selected",!0))},clear:function(){var e=this;e.element.find(e.options.filter+"."+f).removeClass(f),e.options.aria&&e.element.children("[aria-selected=true]").attr("aria-selected",!1)},selectRange:function(t,n){var r=this,i=!1,o=s(r._selectElement,r),u;t=e(t)[0],n=e(n)[0],r.element.find(r.options.filter).each(function(){u=e(this);if(i)o(this),i=this!==n;else if(this===t)i=t!==n,o(this);else if(this===n){var r=t;t=n,n=r,i=!0,o(this)}else u.removeClass(f)}),r.trigger(d,{})},destroy:function(){var e=this;i.fn.destroy.call(e),e.element.off(v)}});n.ui.plugin(y)})(jQuery);