/*
* Kendo UI Beta v2012.3.1024 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Beta license terms available at
* http://www.kendoui.com/purchase/license-agreement/kendo-ui-beta.aspx
*/

;(function(e,t){function q(t){var n=t.parseFormats;D.normalize(t),n=e.isArray(n)?n:[n],n.splice(0,0,t.format),t.parseFormats=n}function R(e){e.preventDefault()}var n=window.kendo,r=n.ui,i=n.support.touch,s=r.Widget,o=n.parseDate,u=n.keys,a=n.template,f="<div />",l="<span />",c=".kendoDatePicker",h=(i?"touchend":"click")+c,p="open",d="close",v="change",m="dateView",g="disabled",y="k-state-default",b="k-state-focused",w="k-state-selected",E="k-state-disabled",S="k-state-hover",x="keydown"+c,T="mouseenter"+c+" mouseleave"+c,N=(i?"touchstart":"mousedown")+c,C="id",k="min",L="max",A="month",O="aria-disabled",M="aria-expanded",_="aria-hidden",D=n.calendar,P=D.isInRange,H=D.restrictValue,B=D.isEqualDatePart,j=e.extend,F=e.proxy,I=Date,U=function(t){var i=this,s,o=document.body,u=z.sharedCalendar,a=e(f).attr(_,"true").addClass("k-calendar-container").appendTo(o);u||(u=z.sharedCalendar=new r.Calendar(e(f).attr(C,n.guid()).hide().appendTo(o),{focusOnNav:!1}),D.makeUnselectable(u.element)),i.calendar=u,i.options=t=t||{},s=t.id,s&&(s+="_dateview",a.attr(C,s),i._dateViewID=s),i.popup=new r.Popup(a,j(t.popup,t,{name:"Popup",isRtl:n.support.isRtl(t.anchor)})),i.div=a,i._templates(),i.value(t.value)};U.prototype={_calendar:function(){var e=this,t=e.popup,n=e.options,r=e.calendar,i=r.element;i.data(m)!==e&&(i.appendTo(t.element).data(m,e).off(h+" "+x).on(h,"td:has(.k-link)",F(e._click,e)).on(N,R).show(),r.unbind(v).bind(v,n),r.month=e.month,r.options.depth=n.depth,r.options.culture=n.culture,r._footer(e.footer),r.min(n.min),r.max(n.max),r.navigate(e._value,n.start),e.value(e._value))},destroy:function(){var t=this,n=t.calendar,r=n.element,i;r.data(m)===t&&(i=e(".k-calendar-container"),i.length>1?r.hide().appendTo(document.body):(r.off(c),n.destroy(),z.sharedCalendar=null)),t.popup.destroy()},open:function(){var e=this;e._calendar(),e.popup.open()},close:function(){this.popup.close()},min:function(e){this._option(k,e)},max:function(e){this._option(L,e)},toggle:function(){var e=this;e[e.popup.visible()?d:p]()},move:function(e){var t=this,n=e.keyCode,r=t.calendar,i=e.ctrlKey&&n==u.DOWN||n==u.ENTER;if(n==u.ESC){t.close();return}if(e.altKey){n==u.DOWN?(t.open(),e.preventDefault()):n==u.UP&&(t.close(),e.preventDefault());return}if(!t.popup.visible())return;if(i&&r._cell.hasClass(w)){t.close(),e.preventDefault();return}t._current=r._move(e)},value:function(e){var t=this,n=t.calendar,r=t.options;t._value=e,t._current=new I(H(e,r.min,r.max)),n.element.data(m)===t&&n.value(e)},_click:function(e){e.currentTarget.className.indexOf(w)!==-1&&this.close()},_option:function(e,t){var n=this,r=n.options,i=n.calendar;r[e]=t,i.element.data(m)===n&&i[e](t)},_templates:function(){var e=this,t=e.options,r=t.footer,i=t.month||{},s=i.content,o=i.empty;e.month={content:a('<td#=data.cssClass#><a tabindex="-1" class="k-link" href="\\#" '+n.attr("value")+'="#=data.dateString#" title="#=data.title#">'+(s||"#=data.value#")+"</a></td>",{useWithBlock:!!s}),empty:a("<td>"+(o||"&nbsp;")+"</td>",{useWithBlock:!!o})},r!==!1&&(e.footer=a(r||'#= kendo.toString(data,"D","'+t.culture+'") #',{useWithBlock:!1}))}},U.normalize=q,n.DateView=U;var z=s.extend({init:function(e,t){var r=this,i;s.fn.init.call(r,e,t),e=r.element,t=r.options,q(t),r._wrapper(),r.dateView=new U(j({},t,{id:e.attr(C),anchor:r.wrapper,change:function(){r._change(this.value()),r.close()},close:function(t){r.trigger(d)?t.preventDefault():(e.attr(M,!1),i.attr(_,!0))},open:function(t){var n=r.options,s;r.trigger(p)?t.preventDefault():(s=o(e.val(),n.parseFormats,n.culture),s?(r.dateView._current=s,r.dateView.calendar._focus(s)):r.dateView.value(s),e.attr(M,!0),i.attr(_,!1))}})),i=r.dateView.div,r._icon(),e[0].type="text",e.addClass("k-input").on("keydown"+c,F(r._keydown,r)).on("blur"+c,F(r._blur,r)).on("focus"+c,function(e){r._inputWrapper.addClass(b)}).attr({role:"textbox","aria-haspopup":!0,"aria-expanded":!1,"aria-owns":r.dateView._dateViewID}),r._reset(),r._template(),r.enable(!e.is("[disabled]")),r.value(t.value||r.element.val()),n.notify(r)},events:[p,d,v],options:{name:"DatePicker",value:null,footer:"",format:"",culture:"",parseFormats:[],min:new Date(1900,0,1),max:new Date(2099,11,31),start:A,depth:A,animation:{},month:{},ARIATemplate:'Current focused date is #=kendo.toString(data.current, "D")#'},setOptions:function(e){var t=this;s.fn.setOptions.call(t,e),q(t.options),j(t.dateView.options,t.options)},enable:function(e){var t=this,n=t._dateIcon.off(c),r=t._inputWrapper.off(c),i=t.element;e===!1?(r.removeClass(y).addClass(E),i.attr(g,g).attr(O,!0)):(r.addClass(y).removeClass(E).on(T,t._toggleHover),i.removeAttr(g).attr(O,!1),n.on(h,F(t._click,t)).on(N,R))},destroy:function(){var e=this;s.fn.destroy.call(e),e.dateView.destroy(),e.element.off(c),e._dateIcon.off(c),e._inputWrapper.off(c),e._form&&e._form.off("reset",e._resetHandler)},open:function(){this.dateView.open()},close:function(){this.dateView.close()},min:function(e){return this._option(k,e)},max:function(e){return this._option(L,e)},value:function(e){var n=this;if(e===t)return n._value;n._old=n._update(e)},_toggleHover:function(t){i||e(t.currentTarget).toggleClass(S,t.type==="mouseenter")},_blur:function(){var e=this;e.close(),e._change(e.element.val()),e._inputWrapper.removeClass(b)},_click:function(){var e=this,t=e.element;e.dateView.toggle(),!i&&t[0]!==document.activeElement&&t.focus()},_change:function(e){var t=this;e=t._update(e),+t._old!=+e&&(t._old=e,t.trigger(v),t.element.trigger(v))},_keydown:function(e){var t=this,n=t.dateView;!n.popup.visible()&&e.keyCode==u.ENTER?t._change(t.element.val()):(n.move(e),t._updateARIA(n._current))},_icon:function(){var t=this,n=t.element,r;r=n.next("span.k-select"),r[0]||(r=e('<span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-calendar">select</span></span>').insertAfter(n)),t._dateIcon=r.attr({role:"button","aria-controls":t.dateView._dateViewID})},_option:function(e,n){var r=this,i=r.options;if(n===t)return i[e];n=o(n,i.parseFormats,i.culture);if(!n)return;i[e]=new I(n),r.dateView[e](n)},_update:function(e){var t=this,r=t.options,i=r.min,s=r.max,u=o(e,r.parseFormats,r.culture),a;return+u===+t._value?(a=n.toString(u,r.format,r.culture),a!==e&&t.element.val(u===null?e:a),u):(u!==null&&B(u,i)?u=H(u,i,s):P(u,i,s)||(u=null),t._value=u,t.dateView.value(u),t.element.val(u?n.toString(u,r.format,r.culture):e),t._updateARIA(u),u)},_wrapper:function(){var t=this,n=t.element,r;r=n.parents(".k-datepicker"),r[0]||(r=n.wrap(l).parent().addClass("k-picker-wrap k-state-default"),r=r.wrap(l).parent()),r[0].style.cssText=n[0].style.cssText,n.css({width:"100%",height:n[0].style.height}),t.wrapper=r.addClass("k-widget k-datepicker k-header").addClass(n[0].className),t._inputWrapper=e(r[0].firstChild)},_reset:function(){var e=this,t=e.element,n=t.closest("form");n[0]&&(e._resetHandler=function(){e.value(t[0].defaultValue)},e._form=n.on("reset",e._resetHandler))},_template:function(){this._ariaTemplate=a(this.options.ARIATemplate)},_updateARIA:function(e){this.element.attr("aria-label",this._ariaTemplate({current:e}))}});r.plugin(z)})(jQuery);