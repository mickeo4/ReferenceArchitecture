/*
* Kendo UI Beta v2012.3.1024 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Beta license terms available at
* http://www.kendoui.com/purchase/license-agreement/kendo-ui-beta.aspx
*/

;(function(e,t){var n=window.kendo,r=e.proxy,i="data-dir",s="asc",o="single",u="data-field",a="desc",f=".kendoSortable",l=".k-link",c="aria-sort",h=n.ui.Widget,p=h.extend({init:function(e,t){var n=this,i;h.fn.init.call(n,e,t),n._refreshHandler=r(n.refresh,n),n.dataSource=n.options.dataSource.bind("change",n._refreshHandler),i=n.element.find(l),i[0]||(i=n.element.wrapInner('<a class="k-link" href="#"/>').find(l)),n.link=i,n.element.on("click"+f,r(n._click,n))},options:{name:"Sortable",mode:o,allowUnsort:!0},destroy:function(){var e=this;h.fn.destroy.call(e),e.element.off(f),e.dataSource.unbind("change",e._refreshHandler)},refresh:function(){var t=this,n=t.dataSource.sort()||[],r,o,f,l,h=t.element,p=h.attr(u);h.removeAttr(i),h.removeAttr(c);for(r=0,o=n.length;r<o;r++)f=n[r],p==f.field&&h.attr(i,f.dir);l=h.attr(i),h.find(".k-i-arrow-n,.k-i-arrow-s").remove(),l===s?(e('<span class="k-icon k-i-arrow-n" />').appendTo(t.link),h.attr(c,"ascending")):l===a&&(e('<span class="k-icon k-i-arrow-s" />').appendTo(t.link),h.attr(c,"descending"))},_click:function(e){var n=this,r=n.element,f=r.attr(u),l=r.attr(i),c=n.options,h=n.dataSource.sort()||[],p,d;l===s?l=a:l===a&&c.allowUnsort?l=t:l=s;if(c.mode===o)h=[{field:f,dir:l}];else if(c.mode==="multiple"){for(p=0,d=h.length;p<d;p++)if(h[p].field===f){h.splice(p,1);break}h.push({field:f,dir:l})}e.preventDefault(),n.dataSource.sort(h)}});n.ui.plugin(p)})(jQuery);