/*
* Kendo UI Beta v2012.3.1024 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Beta license terms available at
* http://www.kendoui.com/purchase/license-agreement/kendo-ui-beta.aspx
*/

;(function(e,t){var n=window.kendo,r=n.mobile,i=r.ui,s=e.proxy,o=n.fx.Transition,u=n.ui.Pane,a=n.ui.PaneDimensions,f=i.Widget,l=Math,c=l.abs,h=l.ceil,p=l.round,d=l.max,v=l.min,m=l.floor,g="change",y="km-current-page",b=f.extend({init:function(t,r){var i=this;f.fn.init.call(i,t,r),t=i.element,t.wrapInner("<div/>").addClass("km-scrollview").append('<ol class="km-pages"/>'),i.inner=t.children().first(),i.pager=t.children().last(),i.page=0;var l,h,p,d,v,m;l=new n.ui.Movable(i.inner),h=new o({axis:"x",movable:l,onEnd:s(i._transitionEnd,i)}),p=new n.UserEvents(t,{start:function(e){c(e.x.velocity)*2>=c(e.y.velocity)?p.capture():p.cancel(),h.cancel()},allowSelection:!0,end:s(i._dragEnd,i)}),d=new a({element:i.inner,container:i.element}),v=d.x,v.bind(g,s(i.refresh,i)),m=new u({dimensions:d,userEvents:p,movable:l,elastic:!0}),e.extend(i,{movable:l,transition:h,userEvents:p,dimensions:d,dimension:v,pane:m}),i.page=i.options.page},options:{name:"ScrollView",page:0,duration:300,velocityThreshold:.8,bounceVelocityThreshold:1.6},events:[g],destroy:function(){f.fn.destroy.call(this),this.userEvents.destroy(),n.destroy(this.element)},viewShow:function(e){this.dimensions.refresh()},refresh:function(){var e=this,t="",n=e.dimension,r=n.getSize(),i;e.element.find("[data-role=page]").width(r),n.update(!0),e.page=Math.floor(-e.movable.x/r),e.scrollTo(e.page),i=e.pages=h(n.getTotal()/r),e.minSnap=-(i-1)*r,e.maxSnap=0;for(var s=0;s<i;s++)t+="<li/>";e.pager.html(t),e._updatePager()},content:function(e){this.element.children().first().html(e),this.dimensions.refresh()},scrollTo:function(e){this.page=e,this._moveTo(-e*this.dimension.getSize(),o.easeOutExpo)},_moveTo:function(e,t){this.transition.moveTo({location:e,duration:this.options.duration,ease:t})},_dragEnd:function(e){var t=this,n=e.x.velocity,r=t.dimension.size,i=t.options,s=i.velocityThreshold,u,a=p,f=o.easeOutExpo;n>s?a=h:n<-s&&(a=m),c(n)>i.bounceVelocityThreshold&&(f=o.easeOutBack),u=d(t.minSnap,v(a(t.movable.x/r)*r,t.maxSnap)),this._moveTo(u,f)},_transitionEnd:function(){var e=this,t=Math.round(-e.movable.x/e.dimension.size);t!=e.page&&(e.page=t,e.trigger(g,{page:t}),e._updatePager())},_updatePager:function(){this.pager.children().removeClass(y).eq(this.page).addClass(y)}});i.plugin(b)})(jQuery);